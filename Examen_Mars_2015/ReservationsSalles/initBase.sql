DROP TABLE RESA;
DROP TABLE SALLES;
DROP TABLE COMPTES_UTILISATEURS;
DROP SEQUENCE noResaSeq;

CREATE TABLE COMPTES_UTILISATEURS (
 ID_UTILISATEUR VARCHAR2(32) NOT NULL,
 NOM VARCHAR2(50) NOT NULL,
 PRENOM VARCHAR2(32) NOT NULL,
 EMAIL VARCHAR2(32) NOT NULL,
 PASSWORD VARCHAR2(16),
 PRIMARY KEY (ID_UTILISATEUR));

CREATE TABLE SALLES (
   NO_SALLE INTEGER NOT NULL,
   TYPE_SALLE VARCHAR2(5) NOT NULL,
   CAPACITE_SALLE INTEGER NOT NULL,
   CHECK (TYPE_SALLE in ('TD','TP','AMPHI')),
   PRIMARY KEY (NO_SALLE));
 
CREATE TABLE RESA (
   NO_SALLE INTEGER NOT NULL,
   ID_UTILISATEUR VARCHAR2(32) NOT NULL,
   DATE_RESA DATE NOT NULL,
   MATIN CHAR DEFAULT '1' NOT NULL,
   No_RESA INTEGER NOT NULL,
   CHECK(MATIN in (0,1)),
   PRIMARY KEY (NO_SALLE, ID_UTILISATEUR,DATE_RESA,MATIN ),
   FOREIGN KEY (NO_SALLE) REFERENCES SALLES (NO_SALLE),
   FOREIGN KEY (ID_UTILISATEUR) REFERENCES COMPTES_UTILISATEURS (ID_UTILISATEUR));

CREATE SEQUENCE noResaSeq START WITH 1 INCREMENT BY 1;

INSERT INTO COMPTES_UTILISATEURS (ID_UTILISATEUR, NOM, PRENOM, EMAIL, PASSWORD) 
	VALUES ('toto38', 'LEHEROS', 'Toto', 'toto38@gmail.com', '$toto38%');
INSERT INTO COMPTES_UTILISATEURS (ID_UTILISATEUR, NOM, PRENOM, EMAIL, PASSWORD) 
	VALUES ('titi38', 'AIGROSMINAIS', 'Titi', 'titi38@hotmail.com', '38%titi%');
INSERT INTO COMPTES_UTILISATEURS (ID_UTILISATEUR, NOM, PRENOM, EMAIL, PASSWORD) 
	VALUES ('riri38', 'FIFI', 'Riri', 'riri38@gmail.com', 'rififi38*');

INSERT INTO SALLES (NO_SALLE, TYPE_SALLE, CAPACITE_SALLE) 
	VALUES (22, 'AMPHI', 80);
INSERT INTO SALLES (NO_SALLE, TYPE_SALLE, CAPACITE_SALLE) 
	VALUES (18, 'AMPHI', 100);
INSERT INTO SALLES (NO_SALLE, TYPE_SALLE, CAPACITE_SALLE)  
	VALUES (101, 'TD', 32);
INSERT INTO SALLES (NO_SALLE, TYPE_SALLE, CAPACITE_SALLE) 
	VALUES (102, 'TD', 40);
INSERT INTO SALLES (NO_SALLE, TYPE_SALLE, CAPACITE_SALLE) 
	VALUES (103, 'TD', 36);
INSERT INTO SALLES (NO_SALLE, TYPE_SALLE, CAPACITE_SALLE) 
	VALUES (104, 'TD', 36);
INSERT INTO SALLES (NO_SALLE, TYPE_SALLE, CAPACITE_SALLE) 
	VALUES (105, 'TD', 36);
INSERT INTO SALLES (NO_SALLE, TYPE_SALLE, CAPACITE_SALLE) 
	VALUES (201, 'TP', 32);
INSERT INTO SALLES (NO_SALLE, TYPE_SALLE, CAPACITE_SALLE) 
	VALUES (202, 'TP', 16);
INSERT INTO SALLES (NO_SALLE, TYPE_SALLE, CAPACITE_SALLE) 
	VALUES (203, 'TP', 32);
INSERT INTO SALLES (NO_SALLE, TYPE_SALLE, CAPACITE_SALLE) 
	VALUES (204, 'TP', 24);
INSERT INTO SALLES (NO_SALLE, TYPE_SALLE, CAPACITE_SALLE) 
	VALUES (205, 'TP' , 40);

INSERT INTO RESA (NO_SALLE, ID_UTILISATEUR, DATE_RESA, MATIN, NO_RESA) 
	VALUES (201, 'titi38', to_date('27/03/2015', 'DD/MM/YYYY'), '0', noResaSeq.NEXTVAL);
INSERT INTO RESA (NO_SALLE, ID_UTILISATEUR, DATE_RESA, MATIN, NO_RESA) 
	VALUES (101, 'titi38', to_date('27/03/2015', 'DD/MM/YYYY'), '1', noResaSeq.NEXTVAL);
INSERT INTO RESA (NO_SALLE, ID_UTILISATEUR, DATE_RESA, MATIN, NO_RESA) 
	VALUES (22, 'titi38', to_date('20/03/2015', 'DD/MM/YYYY'), '1', noResaSeq.NEXTVAL);
INSERT INTO RESA (NO_SALLE, ID_UTILISATEUR, DATE_RESA, MATIN, NO_RESA) 
	VALUES (22, 'riri38', to_date('27/03/2015', 'DD/MM/YYYY'), '0', noResaSeq.NEXTVAL);
INSERT INTO RESA (NO_SALLE, ID_UTILISATEUR, DATE_RESA, MATIN, NO_RESA) 
	VALUES (202, 'riri38', to_date('27/03/2015', 'DD/MM/YYYY'), '1', noResaSeq.NEXTVAL);
INSERT INTO RESA (NO_SALLE, ID_UTILISATEUR, DATE_RESA, MATIN, NO_RESA) 
	VALUES (102, 'titi38', to_date('27/03/2015', 'DD/MM/YYYY'), '1', noResaSeq.NEXTVAL);
INSERT INTO RESA (NO_SALLE, ID_UTILISATEUR, DATE_RESA, MATIN, NO_RESA) 
	VALUES (105, 'titi38', to_date('21/03/2015', 'DD/MM/YYYY'), '1', noResaSeq.NEXTVAL);
INSERT INTO RESA (NO_SALLE, ID_UTILISATEUR, DATE_RESA, MATIN, NO_RESA) 
	VALUES (18, 'titi38', to_date('21/03/2015', 'DD/MM/YYYY'), '0', noResaSeq.NEXTVAL);
INSERT INTO RESA (NO_SALLE, ID_UTILISATEUR, DATE_RESA, MATIN, NO_RESA) 
	VALUES (104, 'toto38', to_date('30/03/2015', 'DD/MM/YYYY'), '0', noResaSeq.NEXTVAL);
INSERT INTO RESA (NO_SALLE, ID_UTILISATEUR, DATE_RESA, MATIN, NO_RESA) 
	VALUES (18, 'toto38', to_date('31/03/2015', 'DD/MM/YYYY'), '1', noResaSeq.NEXTVAL);
